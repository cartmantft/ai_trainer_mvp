# 🧩 MVP 최소 기능 세트 정의서 (2025-03-23 기준)

## 🎯 핵심 목표
- 스쿼트 동작 인식 및 반복 카운트 기능을 중심으로 한 AI 피드백 MVP

---

## ✅ 포함 기능 (v0.1 기준)

1. **실시간 자세 인식 (MediaPipe Pose)**
   - 웹캠 또는 비디오 기반 입력
   - 주요 관절 좌표 추출 (Hip, Knee, Ankle)

2. **좌/우 자동 판단**
   - 보이는 쪽 다리를 기준으로 분석
   - landmark x좌표 비교 기반

3. **스쿼트 상태 판별 (추세 기반)**
   - DOWN → UP 방향 전환 기준으로 카운트
   - 관절 각도 기반 임계값
     - DOWN: <130도
     - UP: >150도
   - 이전 프레임 각도와의 추세 변화 고려

4. **스쿼트 카운트 측정**
   - 반복 동작 인식 시 카운트 증가
   - 총 카운트 실시간 표시

5. **기본 피드백 출력**
   - 콘솔 로그 또는 화면 내 텍스트 출력

6. **디버깅용 landmark 시각화 및 로그**
   - 추세/각도 로그 주기 출력
   - landmark 좌표 출력 (개발자 전용)

---

## 📝 제외 기능 (후속 개발 예정)
- TFLite 변환 및 모바일 내장
- 전문가 자세 비교 기반 유사도 분석
- 음성 피드백 시스템
- 사용자 맞춤 운동 루틴 UI 연결
- 자세 종류 선택 기능
- 초급자/전문가 모드 분기 (TODO로 분리)

---

## 📌 비고
- 첫 MVP는 **정확성보다는 구조와 반응 흐름** 중심
- 영상 기반 테스트 완료됨 (좌/우 방향 모두 정상 인식)






현재 개발 중인 측면 뷰 기반의 스쿼트 분석 MVP에서 주로 감지하고 피드백해야 할 대표적인 잘못된 자세들을 다시 정리해 드리겠습니다.

현재 코드 로직에서 집중하고 있는 오류들은 다음과 같습니다:

불충분한 깊이 (Insufficient Depth):

현상: 스쿼트 시 엉덩이가 충분히 내려가지 않는 자세입니다. 일반적으로 최소한 허벅지가 지면과 평행이 되거나, 엉덩이가 무릎 높이보다 낮아지는 지점까지 내려가는 것이 권장됩니다.

문제점: 둔근과 햄스트링의 활성화를 감소시키고 대퇴사두근(허벅지 앞쪽) 위주로 운동이 편중될 수 있으며, 전체적인 운동 효과가 떨어집니다.

현재 감지 로직 (개선됨): stage == 'DOWN' 이고 무릎 각도가 최저점 부근일 때, hip[1] < knee[1] - DEPTH_THRESHOLD_Y_OFFSET (엉덩이가 무릎보다 높을 때) 조건으로 "더 깊이 앉으세요." 피드백을 제공합니다.

과도한 상체 숙임 (Excessive Forward Lean):

현상: 스쿼트 하강 또는 상승 시, 엉덩이를 뒤로 빼는 대신 상체를 앞으로 과도하게 기울이는 자세입니다.

문제점: 허리에 과도한 부담을 주어 부상 위험을 높이고, 무게 중심이 앞으로 쏠려 불안정해집니다. 둔근/햄스트링보다 허벅지 앞쪽과 허리에 힘이 집중됩니다.

현재 감지 로직 (개선됨): 무릎이 일정 각도 이상 굽혀져 있을 때(knee_angle < UP_POSE_CHECK_ANGLE_THRESHOLD), 상체-수직선 각도(torso_vertical_angle)가 설정된 임계값(LEAN_ANGLE_THRESHOLD)보다 클 경우 "상체를 덜 숙이세요." 피드백을 제공합니다.

발뒤꿈치 들림 (Heels Lifting):

현상: 스쿼트 동작 중, 특히 하강 시 발뒤꿈치가 바닥에서 뜨는 자세입니다.

문제점: 무게 중심이 앞으로 쏠려 불안정해지고 무릎에 부담이 가중될 수 있습니다. 주로 발목 가동성 부족이 원인이며, 운동 효과 분산 및 부상 위험 증가로 이어질 수 있습니다.

현재 감지 로직: 스쿼트 시작 시 발뒤꿈치 Y 좌표를 저장하고, 이후 프레임에서 발뒤꿈치 Y 좌표가 초기 위치보다 설정된 임계값(HEEL_LIFT_THRESHOLD_Y_DIFF) 이상으로 작아지면(위로 올라가면) "발뒤꿈치를 바닥에 붙이세요." 피드백을 제공합니다.

MVP에서 제외되었거나 감지 어려운 자세:

무릎 모임 (Knee Valgus): 측면에서는 관찰 및 정확한 측정이 어렵습니다. (정면 뷰 필요)

비대칭 자세 (Asymmetry): 좌우 불균형은 측면에서 파악하기 어렵습니다. (정면 뷰 필요)

허리 말림/꺾임 (Lumbar Flexion/Extension - Butt Wink): MediaPipe의 기본 랜드마크로는 척추 분절의 미세한 움직임을 정확히 감지하기 매우 어렵습니다. MVP 범위에서는 제외하는 것이 일반적입니다.

잘못된 시선 처리: 측면에서 감지는 가능하나, 위 3가지 주요 오류에 비해 우선순위가 낮을 수 있습니다.

따라서 현재 코드는 측면 뷰에서 감지 가능한 핵심 오류인 깊이, 상체 숙임, 발뒤꿈치 들림 세 가지에 집중하고 있으며, 각 피드백의 조건과 시점을 개선하는 방향으로 진행되고 있습니다.